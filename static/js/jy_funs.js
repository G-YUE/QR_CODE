var JYWX_TOOL={};JYWX_TOOL.jyTouchAjaxRequest=function(a){if(typeof(a.requestAsyncType)!="boolean"){a.requestAsyncType=true}if(typeof(a.requestParams)!="undefined"&&a.requestParams!=""){a.requestParams+="&t_code="+Date.parse(new Date())}else{a.requestParams="t_code="+Date.parse(new Date())}$.ajax({type:a.requestType,url:a.requestUrl,data:a.requestParams,async:a.requestAsyncType,success:function(b){if(a.callbackSucc){a.callbackSucc(b)}},complete:function(c,b){if(a.callbackComplete){a.callbackComplete(c,b)}}})};JYWX_TOOL.say_hello_requesting=false;JYWX_TOOL.say_hello=function(root_url,auth_str,to_uid_disp,class_obj,class_doing,class_done,fx_source,addon_code){var loading_src="http://images1c.jyimg.com/w4/wap/i/m/2013/04/per-inf/loading.gif";if(JYWX_TOOL.say_hello_requesting){showTextTime("请稍候，正在向会员发眼缘",3000);return false}if(class_obj.attr("sent_hello")=="done"){showTextTime("您今天已经与TA联系过了",3000);return false}showLoading(loading_src,"发送中，请稍候...",0);if(addon_code===undefined){addon_code=false}var url=root_url+"/ajax/say_hello.php";var param=auth_str+"&to_uid="+to_uid_disp;if(!JYWX_TOOL.is_empty(fx_source)){param+="&f="+fx_source}JYWX_TOOL.say_hello_requesting=true;if(!JYWX_TOOL.is_empty(class_doing)){class_obj.addClass(class_doing)}JYWX_TOOL.jyTouchAjaxRequest({requestType:"GET",requestUrl:url,requestParams:param,requestAsyncType:true,callbackSucc:function(msg){eval("var ret_helo = "+msg);if(ret_helo.code!=0){showTextTime(ret_helo.msg,3000)}else{class_obj.attr("sent_hello","done");if(!JYWX_TOOL.is_empty(class_done)){class_obj.addClass(class_done)}if(addon_code){eval(addon_code)}showTextTime(ret_helo.msg,3000)}return false},callbackComplete:function(a,b){clearLoading();JYWX_TOOL.say_hello_requesting=false;if(!JYWX_TOOL.is_empty(class_doing)){class_obj.removeClass(class_doing)}return false}});return false};JYWX_TOOL.is_empty=function(a){return typeof(a)=="undefined"||$.trim(a)==""};JYWX_TOOL.showOKCancelDialog=function(f,e,d,c,b){var a=$('<div class="fixed per-pop-bg"></div><div class="fixed per-pop-pass"><p class="fs12 co9 tac bb1 lh30">提示</p><div class="mt20 p10"><p class="fs12 co3 tac lh20 mb10">'+f+'</p></div><div class="m-20-14 clearfix"><div class="fl jy-btn-d jy-btn-2d"><a class="jy-btn jy-cdialog-btnclickok" href="">'+e+'</a></div><div class="fl jy-btn-d jy-btn-2d jy-btn-g"><a class="jy-btn jy-cdialog-cancel" href="">'+d+"</a></div></div></div>");$("body .jy").append(a);$(".jy-cdialog-cancel").click(function(){$(".per-pop-bg,.per-pop-pass").addClass("dn");a.remove();if(b){b()}return false});$(".jy-cdialog-btnclickok").click(function(){$(".per-pop-bg,.per-pop-pass").addClass("dn");a.remove();if(c){c()}return false});return false};JYWX_TOOL.showOKDialog=function(d,c,b){var a=$('<div class="fixed per-pop-bg"></div><div class="fixed per-pop-pass"><p class="fs12 co9 tac bb1 lh30">提示</p><div class="mt10 p10"><p class="fs12 co3 mt10 lh20 mb10">'+d+'</p></div><div class="m-20-14 clearfix"><div class="fr jy-btn-d jy-btn-2d jy-btn-g"><a class="jy-btn jy-cdialog-cancel" href="">'+c+"</a></div></div></div>");$("body .jy").append(a);$(".jy-cdialog-cancel").click(function(){$(".per-pop-bg,.per-pop-pass").addClass("dn");a.remove();if(b){b()}return false});return false};JYWX_TOOL.judgeIsLJC=function(a){if(typeof(a)=="undefined"||a==""||a==null){return false}for(var b in a){if(a[b].go_8!==undefined){a[b].go=a[b].go_8}if(a[b].go=="999001"||a[b].go=="999002"||a[b].go=="999003"||a[b].go=="999004"||a[b].go=="999008"||a[b].go=="11"){return true}return false}return false};JYWX_TOOL.handleLJC=function(q,p,o,v){if(!JYWX_TOOL.judgeIsLJC(q)){return false}if(typeof(q)!="undefined"){var d=v||{};d.link_param=d.link_param||"";var c="";for(var t in q){if(q[t].go_8!==undefined){q[t].go=q[t].go_8;q[t].link=q[t].link_8}if(q[t].go=="11"){var b=q[t].link;var l=d.link_param||"";if(!!l){if(b.indexOf("?")==-1){b+="?"+l}else{b+="&"+l}}if(!!q[t].who){q[t].who.locaiton.href=b}else{document.location.href=b}return false}if(q[t].go=="999001"||q[t].go=="999008"){c='<div class="hint_mask" id="closeljc">\n';var r=q[t].link;var s="";s=r.replace(/\n/g,"<br />");var h="hint_bg_woman";if(d.user_sex=="f"){h="hint_bg_man"}c+='<div class="xy_hint_int '+h+' clearfix ">\n';c+='<div class="hint_con pr">\n';c+='<div class="close_btn" onclick="JYWX_TOOL.closeLJC(); return false;"></div>\n';c+="<p>"+s+"</p>\n";c+="</div>\n";c+='<div class="hint_btns clearfix">\n';var g=o;var f=p;if(!!q[t].link3){if(q[t].link3[1]){g="JYWX_TOOL.closeLJC()"}if(q[t].link3[0]){f="JYWX_TOOL.closeLJC()"}}c+='<a href="#" class="btn2" onclick="'+g+'; return false;">'+q[t].link2[1]+"</a>\n";c+='<a href="#" class="btn1" onclick="'+f+'; return false;">'+q[t].link2[0]+"</a>\n";c+="</div>\n";if(q[t].go=="999001"&&d.hideCheckbox!==true){c+='<div class="un_tips clearfix">\n';c+='<input type="checkbox" value="" id="butishi" name="butishi"  class="checkbox">\n';c+='<label for="a">不再提示，普通发信</label>\n';c+="</div>\n"}c+="</div>\n";c+="</div>\n"}else{if(q[t].go=="999002"){c='<div class="hint_mask" id="closeljc">\n';c+="<!--余额不足拦截层-->\n";c+='<div class="member_hint">\n';c+='<div class="member_hint_sub">\n';c+='<div class="top_l_are"></div>\n';c+='<div class="top_r_are"></div>\n';var u="return JYWX_TOOL.closeLJC();";var m=' onclick="'+u+'"';c+='<a href="#" class="top_r_off" '+m+"></a>\n";var j=q[t].link.length;var e;for(var a=0;a<j;a++){e=false;if(q[t].link[a].prolist.length>0){if(a==0){c+='<div class="tit_con">\n';c+="<p>"+q[t].link[a].title+"</p>\n";c+="</div>\n"}else{c+='<div class="more_service ">\n';c+="<h4>"+q[t].link[a].title+"</h4>\n";e=true}if(q[t].link[a].prolist[0].type!="buy_service"){c+='<div class="jy_pay_pro">\n';c+='<ul class="pay_list clearfix">\n';for(var n=0;n<q[t].link[a].prolist.length;n++){if(typeof(q[t].link[a].prolist[n].name)!="undefined"&&typeof(q[t].link[a].prolist[n])!="undefined"&&q[t].link[a].prolist[n]!=""&&q[t].link[a].prolist[n]!=null){c+="<li>\n";c+='<a href="'+q[t].link[a].prolist[n].url+"&amp;"+d.link_param+'">\n';c+='<span class="fl">'+q[t].link[a].prolist[n].name+"</span>\n";c+='<i class="fr">¥'+q[t].link[a].prolist[n].price+"</i>\n";if(q[t].link[a].prolist[n].showtype==2){c+='<em><img src="'+q[t].link[a].prolist[n].show+'" alt="."></em>\n'}c+="</a>\n";c+="</li>\n"}}c+="</ul>\n";c+="</div>\n"}else{c+='<ul class="m_ser_list">\n';for(var n=0;n<q[t].link[a].prolist.length;n++){if(typeof(q[t].link[a].prolist[n])!="undefined"&&q[t].link[a].prolist[n]!=""&&q[t].link[a].prolist[n]!=null){c+="<li>\n";c+='<a href="'+q[t].link[a].prolist[n].url+"&amp;"+d.link_param+'" class="clearfix">\n';c+="<span>"+q[t].link[a].prolist[n].name+"</span>\n";c+="<i>¥"+q[t].link[a].prolist[n].price+"</i>\n";if(q[t].link[a].prolist[n].showtype==2){c+='<em><img src="'+q[t].link[a].prolist[n].show+'" alt="."></em>\n'}c+="</a>\n";c+="</li>\n"}}c+="</ul>\n"}if(e){c+="</div>\n"}}}c+="</div>\n";c+="</div>\n";c+="</div>\n"}else{if(q[t].go=="999004"){c='<div class="chat_mask2 pa" id="closeljc"><div class="gift_pop"><div class="top_con"><h1 class="tac">'+q[t].link.title+'</h1><div class="gift_con clearfix"><ul class="clearfix">\n';for(var k in q[t].link.prolist){c+='<li><a  href="'+JYWX_TOOL.getBaseUrl()+"/product/gift/?to_uid="+d.to_uid+"&amp;f=chat&amp;statisticsid="+q[t].link.prolist[k].statisticsid+"&amp;goto_pid=1&amp;pid="+q[t].link.prolist[k].jypid+"&amp;"+d.link_param+'" class="pr"><img src="'+q[t].link.prolist[k].pic+'" alt=""><span class="pa price">'+q[t].link.prolist[k].price+'</span><span class="m_layer pa dn"></span></a><p>'+q[t].link.prolist[k].name+"</p></li>"}c+='<li><a  href="'+JYWX_TOOL.getBaseUrl()+"/product/gift/?to_uid="+d.to_uid+"&amp;f=chat&amp;"+d.link_param+'" class="pr"><img src="http://images1.jyimg.com/w4/wap/i/m/product/chat/chat_icon_17.png" alt=""></a></li></ul></div></div><div class="off tac" onclick="return JYWX_TOOL.closeLJC();">取 消</div></div></div>';$(".jy").append(c);return false}else{showTextTime("您的账户当前状态异常，请稍后再试",2000);return false}}}break}$("body").append(c);$("#closeljc").bind("touchmove",function(i){i.preventDefault()});return false}return false};JYWX_TOOL.closeLJC=function(){$("#closeljc").remove();return false};JYWX_TOOL.getBaseUrl=function(){return window.location.href.indexOf("jiayuan.com")==-1?"/m":""};JYWX_TOOL.getCurrentPosition=function(a){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(b){var c=b.coords.longitude;var d=b.coords.latitude;a({result:true,data:{lng:c,lat:d}})},function(){a({result:false})})}else{a({result:false})}};